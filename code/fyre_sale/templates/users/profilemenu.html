{% load static %}


<div id="profile-menu" onload=getRating style="display: none;">
  <ul id="profile-menu-list">
    {% if user.is_authenticated %}
    <p>{{ user.username }}</p>
    <li><a href="{% url 'profile' username=user.username %}">My profile</a></li>
    <li><a href="{% url 'inbox' username=user.username %}">Inbox</a></li>
    <li><a href="{% url 'signout' %}">Sign out</a></li>
    <li>
      <p id="user-rating-profile-menu"></p>
    </li>
    {% else %}
    <li><a href="{% url 'signin' %}">Sign in</a></li>
    {% endif %}
  </ul>
</div>

<script type="text/javascript">
  window.addEventListener('load', () => {
    fetch('http://localhost:8000/users/api/get_rating/{{ user.id }}')
      .then(response => response.json())
      .then(data => {
        document.getElementById('user-rating-profile-menu')
          .innerHTML = "Your rating: " + data.rating;
      });
  });
</script>
<style>
  #profile-menu {
    position: absolute;
    z-index: 1003;
    width: 150px;
    height: auto;
    background-color: #ffffff;
    top: 60px;
    margin-left: 50px;
    box-shadow: rgb(0 0 0 / 35%) 0px 5px 15px;
  }

  #profile-menu-list {
    float: left;
    list-style-type: none;
    padding: 10px;
  }

  #profile-menu-list li {
    padding: 5px 5px 5px 0;
  }

  #username {
    color: #4a5ee5;
    font-weight: bold;
    text-transform: uppercase;
  }
</style>